<script type="text/javascript">

Homey.setTitle( __('pair.titleselection') );

$(function() {
  var shelly = {};

	$('#again').click(function() {
    Homey.showView('list_devices');
	});

  $('#manual').click(function() {
    Homey.showView('manual_pairing');
	});

  $('#close').click(function() {
    Homey.done();
	});

	$('#connect').click(function() {
		var inputaddress = $('#address').val();
		var inputusername = $('#username').val();
		var inputpassword = $('#password').val();
    var inputpolling = Number($('#polling').val()) || 5;

		if (inputaddress != '' && inputpolling != '') {

      var data = {
        address: inputaddress,
				username: inputusername,
				password: inputpassword,
        polling: inputpolling,
        shelly: shelly
      }

      Homey.emit('manual_pairing', data, function(error, result) {
        if (result) {
          Homey.nextView()
        } else if (error) {
          return Homey.alert(error);
          Homey.done();
        }
      });

		} else {
			$('.shelly-error').show();
			$('.shelly-error-msg').html( __('pair.nosettings') );
		}

	});
})
</script>

<style type="text/css">
  .form-group {
    width: 100%;
    display: block;
    margin-bottom: 12px;
  }
  .buttons {
    text-align: center;
    padding-top: 14px;
  }
  .button {
    display: block;
    min-width: 100%;
    margin-bottom: 8px !important;
  }
</style>

<p data-i18n="pair.nodevices">No devices have been discovered. You can try again or use manual pairing if you know the IP address of your Shelly device.</p>
<div class="shelly-pairing">
	<div class="form-group buttons">
		<button id="again" class="button" data-i18n="pair.again">Try Again</button>
		<button id="manual" class="button" data-i18n="pair.manual">Manual</button>
    <button id="close" class="button" data-i18n="pair.close">Close</button>
	</div>
</div>
